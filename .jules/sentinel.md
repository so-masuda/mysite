## 2024-05-20 - Clickjacking Defense via CSP
**Vulnerability:** The application was missing the `frame-ancestors` directive in its Content Security Policy (CSP). While the older `X-Frame-Options` header was present, it is superseded by the CSP directive. This left the application vulnerable to clickjacking attacks, where an attacker could embed the site in an iframe on a malicious domain to trick users into performing unintended actions.
**Learning:** Defense-in-depth is critical. Relying on a single, older security header (`X-Frame-Options`) is not sufficient when a more modern and effective standard (`CSP frame-ancestors`) is available. The `ContentSecurityPolicyMiddleware` is the central place for managing such headers and should be regularly reviewed for completeness.
**Prevention:** When implementing or reviewing security headers, always prefer the most modern and comprehensive standards. The CSP should be the primary tool for controlling framing, and `X-Frame-Options` should be considered a legacy fallback. Future security reviews should audit the CSP for missing directives.
